{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - Claroty - 1.1.0",
      "description": "Sample playbooks for \"Claroty\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "/api/3/images/64c908a3-fdb4-44dc-aa3d-7434f85542d4",
      "uuid": "8370a01d-a451-4ef2-bbbe-73f1538795a9",
      "id": 206,
      "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "createDate": 1666248652,
      "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "modifyDate": 1666248652,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Assets",
          "aliasName": null,
          "tag": "#Claroty",
          "description": "Get assets from claroty server based on input parameters you have provided.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1666255562,
          "collection": "/api/3/workflow_collections/8370a01d-a451-4ef2-bbbe-73f1538795a9",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a74acb95-27b7-4814-93d5-5b08bd4149c3",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Assets",
              "description": null,
              "arguments": {
                "name": "Claroty",
                "config": "5393c8c1-36dd-413b-b6b2-1dc1de329995",
                "params": {
                  "page": "",
                  "format": "rids",
                  "filters": "{\n  \"description__contains\": \"data\",\n  \"mac__contains\": \"20\"\n}",
                  "per_page": 10,
                  "asset_type__in": [],
                  "timestamp__gte": "2022-10-17T18:30:00.000Z",
                  "timestamp__lte": "2022-10-20T08:07:50.378Z",
                  "protocol__exact": [],
                  "criticality__exact": []
                },
                "version": "1.0.0",
                "connector": "claroty",
                "operation": "get_assets",
                "operationTitle": "Get Assets",
                "step_variables": []
              },
              "status": null,
              "top": "120",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "24e88a4a-bb2c-4bbe-bff6-3fd4f1801012",
              "id": 8532
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "ddd91c24-64c5-4a55-93a9-fc9ba5dcc79c",
                "title": "Claroty: Get Assets",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "a74acb95-27b7-4814-93d5-5b08bd4149c3",
              "id": 8533
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Assets",
              "targetStep": "/api/3/workflow_steps/24e88a4a-bb2c-4bbe-bff6-3fd4f1801012",
              "sourceStep": "/api/3/workflow_steps/a74acb95-27b7-4814-93d5-5b08bd4149c3",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "28655d93-22cf-489e-a628-f13e5eb4638f"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "22fcdc4b-6ed2-421a-a505-a1e2d49e3292",
          "id": 711,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Claroty"
          ],
          "id": 3152,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1666248652,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1666257324,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Alerts",
          "aliasName": null,
          "tag": "#Claroty",
          "description": "Get Alerts from claroty server based on input parameters you have provided.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1666256593,
          "collection": "/api/3/workflow_collections/8370a01d-a451-4ef2-bbbe-73f1538795a9",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/60c1e601-c373-4d6c-bdac-6d121fefe4ee",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Alerts",
              "description": null,
              "arguments": {
                "name": "Claroty",
                "config": "5393c8c1-36dd-413b-b6b2-1dc1de329995",
                "params": {
                  "page": "",
                  "format": "",
                  "filters": "{\n  \"score__exact\": \"100\",\n  \"description__contains\": \"TCP\"\n}",
                  "per_page": "",
                  "timestamp__gte": "2022-10-17T18:30:00.000Z",
                  "timestamp__lte": "2022-10-20T08:12:33.771Z",
                  "category__exact": "",
                  "severity__exact": [
                    "Critical",
                    "High",
                    "Medium",
                    "Low"
                  ],
                  "resolution__exact": ""
                },
                "version": "1.0.0",
                "connector": "claroty",
                "operation": "get_alerts",
                "operationTitle": "Get Alerts",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "57dc33d6-1582-40e1-8687-55d48eb40b72",
              "id": 8535
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "96ef1937-f81d-4125-a73d-d5c6bf3f863c",
                "title": "Claroty: Get Alerts",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "60c1e601-c373-4d6c-bdac-6d121fefe4ee",
              "id": 8534
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Alerts",
              "targetStep": "/api/3/workflow_steps/57dc33d6-1582-40e1-8687-55d48eb40b72",
              "sourceStep": "/api/3/workflow_steps/60c1e601-c373-4d6c-bdac-6d121fefe4ee",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f3e1e65f-cf92-4d4a-baad-36c82bb83594"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "26837169-a401-4d19-b1c1-f6888f3dbd59",
          "id": 712,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Claroty"
          ],
          "id": 3153,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1666248652,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1666257323,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Alert Details",
          "aliasName": null,
          "tag": "#Claroty",
          "description": "Get alert details based on alert resource id you have provided",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1666087154,
          "collection": "/api/3/workflow_collections/8370a01d-a451-4ef2-bbbe-73f1538795a9",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6c327b6a-e1a5-4d67-ac0c-89153130526b",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Alert Details",
              "description": null,
              "arguments": {
                "name": "Claroty",
                "config": "5393c8c1-36dd-413b-b6b2-1dc1de329995",
                "params": {
                  "resource_id": "9-1"
                },
                "version": "1.0.0",
                "connector": "claroty",
                "operation": "get_alert_details",
                "operationTitle": "Get Alert Details",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "2574753f-8c89-4a77-90a3-60a0407005f7",
              "id": 8537
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "53a1f9d4-e6d9-494c-b7de-8ea3c2da4b8e",
                "title": "Claroty: Get Alert Details",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "6c327b6a-e1a5-4d67-ac0c-89153130526b",
              "id": 8536
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Alert Details",
              "targetStep": "/api/3/workflow_steps/2574753f-8c89-4a77-90a3-60a0407005f7",
              "sourceStep": "/api/3/workflow_steps/6c327b6a-e1a5-4d67-ac0c-89153130526b",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "3a5aea4a-cc8b-485b-89c7-10b40add3c6a"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "3e8a8d84-7088-41be-8b26-815c931a89a8",
          "id": 713,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Claroty"
          ],
          "id": 3154,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1666248652,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1666248652,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Events",
          "aliasName": null,
          "tag": "#Claroty",
          "description": "Get events from claroty server based on input parameters you have provided.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1666087154,
          "collection": "/api/3/workflow_collections/8370a01d-a451-4ef2-bbbe-73f1538795a9",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/8a9902b9-86c6-4ee1-8f0d-4bd0291b89a5",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "c5c5e396-1881-45bf-abcf-89df85ffa5a3",
                "title": "Claroty: Get Events",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "8a9902b9-86c6-4ee1-8f0d-4bd0291b89a5",
              "id": 8539
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Events",
              "description": null,
              "arguments": {
                "name": "Claroty",
                "config": "5393c8c1-36dd-413b-b6b2-1dc1de329995",
                "params": {
                  "page": "",
                  "sort": "",
                  "site_id": "",
                  "per_page": "",
                  "id__exact": "",
                  "type__exact": "eKnownThreatEvent",
                  "status__exact": "",
                  "alert_id__exact": "",
                  "timestamp__exact": "",
                  "description__contains": ""
                },
                "version": "1.0.0",
                "connector": "claroty",
                "operation": "get_events",
                "operationTitle": "Get Events",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "dc054830-dc9b-42b4-8747-0d67901dc01b",
              "id": 8538
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Events",
              "targetStep": "/api/3/workflow_steps/dc054830-dc9b-42b4-8747-0d67901dc01b",
              "sourceStep": "/api/3/workflow_steps/8a9902b9-86c6-4ee1-8f0d-4bd0291b89a5",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "507aa754-ca34-4592-8f5e-2dee643b2cce"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "80d69a76-adb8-493d-897e-5b6eafae0d04",
          "id": 714,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Claroty"
          ],
          "id": 3155,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1666248652,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1666248652,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Insights",
          "aliasName": null,
          "tag": "#Claroty",
          "description": "Get summary of an insights based on input parameters you have provided.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1666087154,
          "collection": "/api/3/workflow_collections/8370a01d-a451-4ef2-bbbe-73f1538795a9",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/e6b236d7-84ff-4acd-878a-e25ea888b4c7",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Insights",
              "description": null,
              "arguments": {
                "name": "Claroty",
                "config": "5393c8c1-36dd-413b-b6b2-1dc1de329995",
                "params": {
                  "page": "",
                  "sort": "-risk_level",
                  "format": "insight_page",
                  "per_page": 2,
                  "ghost__exact": "",
                  "site_id__exact": "",
                  "special_hint__exact": "",
                  "insight_status__exact": ""
                },
                "version": "1.0.0",
                "connector": "claroty",
                "operation": "get_insights",
                "operationTitle": "Get Insights",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "8cefb0e6-9ccf-44e6-b732-bb7c84c06bd8",
              "id": 8540
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "dc4fc277-43f7-4c11-9cd3-24c8219c4cc9",
                "title": "Claroty: Get Insights",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "e6b236d7-84ff-4acd-878a-e25ea888b4c7",
              "id": 8541
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Insights",
              "targetStep": "/api/3/workflow_steps/8cefb0e6-9ccf-44e6-b732-bb7c84c06bd8",
              "sourceStep": "/api/3/workflow_steps/e6b236d7-84ff-4acd-878a-e25ea888b4c7",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "9c6e0d4f-644a-4cb4-a8d9-570fc8c0b8df"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "8676b0ea-eef9-4792-a3aa-156a0711997c",
          "id": 715,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Claroty"
          ],
          "id": 3156,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1666248652,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1666248652,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": ">> Claroty > Fetch Associated Events for Alerts",
          "aliasName": null,
          "tag": "#claroty #dataingestion",
          "description": "Fetch Associated events for Alerts.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "alertdata",
            "max_events"
          ],
          "synchronous": false,
          "lastModifyDate": 1666087154,
          "collection": "/api/3/workflow_collections/8370a01d-a451-4ef2-bbbe-73f1538795a9",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/61ff2660-a260-47ee-9202-baa7f99f4eb5",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Fetch Related Events",
              "description": null,
              "arguments": {
                "name": "Claroty",
                "config": "6474e396-6710-4b11-ad64-d9f0ccec2587",
                "params": {
                  "page": "",
                  "sort": "",
                  "site_id": "",
                  "per_page": "{{vars.input.params['max_events']}}",
                  "id__exact": "",
                  "type__exact": "",
                  "status__exact": "",
                  "alert_id__exact": "{{vars.input.params.alertdata.resource_id}}",
                  "timestamp__exact": "",
                  "description__contains": ""
                },
                "version": "1.0.0",
                "connector": "claroty",
                "operation": "get_events",
                "operationTitle": "Get Events",
                "pickFromTenant": false,
                "step_variables": {
                  "fetch_event": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "140",
              "left": "200",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "346fdc76-9a76-4562-9014-8d7c5a7a3a33",
              "id": 8545
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Record",
              "description": null,
              "arguments": {
                "resource": {
                  "sourcedata": "{{vars.alert_details | toJSON }}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.alertdata['@id']}}",
                "__recommend": [],
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "440",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "group": null,
              "uuid": "34bb8f88-b478-4167-862f-de0cac972abd",
              "id": 8543
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "61ff2660-a260-47ee-9202-baa7f99f4eb5",
              "id": 8542
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Result",
              "description": null,
              "arguments": {
                "alert_details": "{\"alert_data\":  {{vars.input.params.alertdata.sourcedata | toDict}}, \"associated_events\": {{vars.fetch_event.data}} }"
              },
              "status": null,
              "top": "300",
              "left": "420",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "7c33e60f-38f0-45ae-a794-d3b584249859",
              "id": 8544
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Related Events -> Set Result",
              "targetStep": "/api/3/workflow_steps/7c33e60f-38f0-45ae-a794-d3b584249859",
              "sourceStep": "/api/3/workflow_steps/346fdc76-9a76-4562-9014-8d7c5a7a3a33",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "41a4a371-0a9b-4710-bc3b-86bfd2ef1a46"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Fetch Related Events",
              "targetStep": "/api/3/workflow_steps/346fdc76-9a76-4562-9014-8d7c5a7a3a33",
              "sourceStep": "/api/3/workflow_steps/61ff2660-a260-47ee-9202-baa7f99f4eb5",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "7d01dbf0-6045-457f-b4cd-beb45d9c2ee4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Result -> Update Alert",
              "targetStep": "/api/3/workflow_steps/34bb8f88-b478-4167-862f-de0cac972abd",
              "sourceStep": "/api/3/workflow_steps/7c33e60f-38f0-45ae-a794-d3b584249859",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "cb356e1c-ffbc-4dda-acb4-b9d0d7b3fde6"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "8bf6d636-9604-416b-832f-059fa9835520",
          "id": 716,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "Claroty"
          ],
          "id": 3157,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1666248652,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1666248652,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Tasks",
          "aliasName": null,
          "tag": "#Claroty",
          "description": "Get all tasks and their information",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1666087154,
          "collection": "/api/3/workflow_collections/8370a01d-a451-4ef2-bbbe-73f1538795a9",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/20973c61-9269-4237-a194-f427cd592bf7",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "43bcb7f2-69bb-4bb0-ad1b-28f5c692cd26",
                "title": "Claroty: Get Tasks",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "20973c61-9269-4237-a194-f427cd592bf7",
              "id": 8547
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Tasks",
              "description": null,
              "arguments": {
                "name": "Claroty",
                "config": "5393c8c1-36dd-413b-b6b2-1dc1de329995",
                "params": {
                  "page": "",
                  "sort": "",
                  "per_page": "",
                  "site_id__exact": "",
                  "name__icontains": ""
                },
                "version": "1.0.0",
                "connector": "claroty",
                "operation": "get_tasks",
                "operationTitle": "Get Tasks",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "4a712993-75d3-44cf-a412-376e7ca67e9f",
              "id": 8546
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Tasks",
              "targetStep": "/api/3/workflow_steps/4a712993-75d3-44cf-a412-376e7ca67e9f",
              "sourceStep": "/api/3/workflow_steps/20973c61-9269-4237-a194-f427cd592bf7",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "ba2baa0e-f360-4e51-801f-9bffa81e97fa"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "912250fc-8b91-4a82-b023-87c6984d9488",
          "id": 717,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Claroty"
          ],
          "id": 3158,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1666248652,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1666248652,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Claroty > Ingest",
          "aliasName": null,
          "tag": "#claroty #dataingestion #create #ingest",
          "description": "Fetch Alerts from the Claroty and Creates records in FortiSOAR.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1681118898,
          "collection": "/api/3/workflow_collections/8370a01d-a451-4ef2-bbbe-73f1538795a9",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/12f9618c-4617-42d5-be4f-4586a48a1401",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "cd4d9561-44a2-4342-835e-af42950c9c4a",
                "title": "Claroty > Ingest",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "12f9618c-4617-42d5-be4f-4586a48a1401",
              "id": 8548
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Last Detection Fetch Macro",
              "description": null,
              "arguments": {
                "config": "32a9a084-8135-41bb-8649-569c45d80505",
                "params": {
                  "macro": "{{vars.steps.Fetch_Alerts.claroty_macro_name}}",
                  "value": "{{vars.steps.Fetch_Alerts.curr_timestamp}}"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "CyOPs: Update Macro",
                "step_variables": []
              },
              "status": null,
              "top": "440",
              "left": "800",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "33a84f33-cd3a-4877-a04c-8214e6bfe290",
              "id": 8551
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Related Events",
              "description": null,
              "arguments": {
                "when": "{{vars.steps.Fetch_Alerts.data|length > 0}}",
                "for_each": {
                  "item": "{{vars.steps.Create_Record}}",
                  "__bulk": false,
                  "parallel": true,
                  "condition": ""
                },
                "arguments": {
                  "alertdata": "{{vars.item}}",
                  "max_events": "{{vars.steps.Fetch_Alerts.max_event_count}}"
                },
                "apply_async": true,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/8bf6d636-9604-416b-832f-059fa9835520"
              },
              "status": null,
              "top": "560",
              "left": "960",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "444828e0-9c7f-4614-8657-73177291d7ba",
              "id": 8553
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Alerts",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "pass_input_record": true,
                "workflowReference": "/api/3/workflows/c8d134aa-6306-48bb-8dff-d4f650dddee5"
              },
              "status": null,
              "top": "120",
              "left": "280",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "4af6ada1-1998-4a3c-8994-d2f8fdeb733a",
              "id": 8552
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "when": "{{vars.steps.Fetch_Alerts.data|length > 0}}",
                "for_each": {
                  "item": "{{vars.steps.Fetch_Alerts.data}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "name": "{{vars.item[\"id\"]}} : {{vars.item[\"type__\"]}}",
                  "type": {
                    "id": 79,
                    "@id": "/api/3/picklists/574a6ee2-7265-4701-815e-cff83b053bce",
                    "icon": null,
                    "uuid": "574a6ee2-7265-4701-815e-cff83b053bce",
                    "@type": "Picklist",
                    "color": null,
                    "display": "Other / Unknown",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Other / Unknown",
                    "orderIndex": 13
                  },
                  "state": {
                    "id": 157,
                    "@id": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                    "icon": null,
                    "uuid": "a1bac09b-1441-45aa-ad1b-c88744e48e72",
                    "@type": "Picklist",
                    "color": null,
                    "display": "New",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "New",
                    "orderIndex": 0
                  },
                  "source": "Claroty",
                  "status": {
                    "id": 118,
                    "@id": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                    "icon": null,
                    "uuid": "7de816ff-7140-4ee5-bd05-93ce22002146",
                    "@type": "Picklist",
                    "color": null,
                    "display": "Open",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Open",
                    "orderIndex": 1
                  },
                  "severity": "{{\"Severity\" | picklist(vars.item['severity__'][1:], \"@id\")}}",
                  "sourceId": "{{vars.item[\"resource_id\"]}}",
                  "__replace": "true",
                  "eventTime": "{{vars.item[\"timestamp\"]}}",
                  "sourcedata": "{{vars.item | toJSON }}",
                  "description": "Score: {{vars.item[\"score\"]}}\n\nType: {{vars.item[\"type\"]}}\n\nNetwork ID: {{vars.item[\"network\"][\"id\"]}}\n\nNetwork Name: {{vars.item[\"network\"][\"name\"]}}\n\nCategory: {{vars.item[\"category__\"]}}\n\nDescription: {{vars.item[\"description\"]}}\n\n\n",
                  "ackSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "closureReason": {
                    "id": 250,
                    "@id": "/api/3/picklists/8590c81e-3307-4645-97f5-c3e1bec4e05a",
                    "icon": null,
                    "uuid": "8590c81e-3307-4645-97f5-c3e1bec4e05a",
                    "@type": "Picklist",
                    "color": null,
                    "display": "Tasks Completed",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/4ebacea1-88cd-4ea8-9dcc-385bea42cc59",
                    "itemValue": "Tasks Completed",
                    "orderIndex": 0
                  },
                  "respSlaStatus": {
                    "id": 7,
                    "@id": "/api/3/picklists/090115d7-90fc-4dc6-97ca-27950fc30c1c",
                    "icon": null,
                    "uuid": "090115d7-90fc-4dc6-97ca-27950fc30c1c",
                    "@type": "Picklist",
                    "color": "#14b341",
                    "display": "Met",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Met",
                    "orderIndex": 0
                  },
                  "priorityWeight": 1,
                  "escalatedtoincident": {
                    "id": 31,
                    "@id": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                    "icon": null,
                    "uuid": "2128a09c-153d-4db3-985d-de6be33deae5",
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "No",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                    "itemValue": "No",
                    "orderIndex": 1
                  },
                  "resolvedAutomatedly": false,
                  "alertRemainingAckSLA": 0
                },
                "_showJson": true,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/alerts",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "320",
              "left": "640",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "4c90ba2e-ee3a-4013-a12b-1eec350afce4",
              "id": 8549
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "alerts_type_map": "{}",
                "alerts_state_map": "{}",
                "alerts_status_map": "{}",
                "alerts_ackSlaStatus_map": "{}",
                "alerts_closureReason_map": "{}",
                "alerts_respSlaStatus_map": "{}",
                "alerts_escalatedtoincident_map": "{}"
              },
              "status": null,
              "top": "220",
              "left": "480",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "a4e8d35a-82cd-4a7f-9b70-f608a9204122",
              "id": 8550
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Create Record -> Update Last Detection Fetch Macro",
              "targetStep": "/api/3/workflow_steps/33a84f33-cd3a-4877-a04c-8214e6bfe290",
              "sourceStep": "/api/3/workflow_steps/4c90ba2e-ee3a-4013-a12b-1eec350afce4",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "6d360c04-c79f-485a-af1a-021d176ef84c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Create Record",
              "targetStep": "/api/3/workflow_steps/4c90ba2e-ee3a-4013-a12b-1eec350afce4",
              "sourceStep": "/api/3/workflow_steps/a4e8d35a-82cd-4a7f-9b70-f608a9204122",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "92e8d37b-8747-46ff-8732-05a099ffd792"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Fetch Detections",
              "targetStep": "/api/3/workflow_steps/4af6ada1-1998-4a3c-8994-d2f8fdeb733a",
              "sourceStep": "/api/3/workflow_steps/12f9618c-4617-42d5-be4f-4586a48a1401",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a465b383-057c-41cc-89e6-e26a0698e9a5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Last Detection Fetch Macro -> Get Related Events",
              "targetStep": "/api/3/workflow_steps/444828e0-9c7f-4614-8657-73177291d7ba",
              "sourceStep": "/api/3/workflow_steps/33a84f33-cd3a-4877-a04c-8214e6bfe290",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "bb52ddf3-ce2a-412e-9e55-e07239e65d40"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Detections -> Configuration",
              "targetStep": "/api/3/workflow_steps/a4e8d35a-82cd-4a7f-9b70-f608a9204122",
              "sourceStep": "/api/3/workflow_steps/4af6ada1-1998-4a3c-8994-d2f8fdeb733a",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "d3dbb926-2bb7-4916-b880-d42c45faed18"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "b1a96a4e-6179-4dfd-8228-18f26c8f02b9",
          "id": 718,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "create",
            "ingest",
            "Claroty"
          ],
          "id": 3159,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1666248652,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1666248652,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> Claroty > Fetch",
          "aliasName": null,
          "tag": "#claroty #fetch #dataingestion",
          "description": "Fetch alerts from Claroty.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1681118234,
          "collection": "/api/3/workflow_collections/8370a01d-a451-4ef2-bbbe-73f1538795a9",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/23d7566f-a791-4ba2-bff2-6badff10278f",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Alerts",
              "description": null,
              "arguments": {
                "name": "Claroty",
                "config": "6474e396-6710-4b11-ad64-d9f0ccec2587",
                "params": {
                  "page": "",
                  "format": "asset_list",
                  "filters": "{{vars.filters}}",
                  "per_page": "{{vars.per_page}}",
                  "timestamp__gte": "{{vars.last_pull_time}}",
                  "timestamp__lte": "{{vars.curr_timestamp}}",
                  "category__exact": "{{vars.category__exact}}",
                  "severity__exact": "{{vars.severity__exact}}",
                  "resolution__exact": "{{vars.resolution__exact}}"
                },
                "version": "1.0.0",
                "connector": "claroty",
                "operation": "get_alerts",
                "operationTitle": "Get Alerts",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "480",
              "left": "800",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "08626030-9893-42e4-9ff6-29e432586719",
              "id": 8554
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n  {\n    \"title\": \"Pull Alerts From Last X Minutes\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"type\": \"text\",\n    \"name\": \"minutes\",\n    \"tooltip\": \"Fetch alerts from last X minutes. e.g 5\",\n    \"value\": 5\n  },\n  {\n    \"title\": \"Status\",\n    \"name\": \"resolution__exact\",\n    \"type\": \"multiselect\",\n    \"options\": [\n      \"Resolved\",\n      \"Unresolved\"\n    ],\n    \"value\": \"Resolved\",\n    \"visible\": true,\n    \"editable\": true,\n    \"required\": false,\n    \"tooltip\": \"Maximum number of alerts to return in response\",\n    \"description\": \"Maximum number of alerts to return in response\"\n  },\n  {\n    \"title\": \"Category\",\n    \"name\": \"category__exact\",\n    \"type\": \"multiselect\",\n    \"options\": [\n      \"Security\",\n      \"Integrity\"\n    ],\n    \"visible\": true,\n    \"editable\": true,\n    \"required\": false,\n    \"tooltip\": \"Maximum number of alerts to return in response\",\n    \"description\": \"Maximum number of alerts to return in response\"\n  },\n  {\n    \"title\": \"Alert Severity\",\n    \"name\": \"severity__exact\",\n    \"type\": \"multiselect\",\n    \"options\": [\n      \"Critical\",\n      \"High\",\n      \"Medium\",\n      \"Low\"\n    ],\n    \"visible\": true,\n    \"editable\": true,\n    \"required\": false,\n    \"tooltip\": \"Select asset Criticality to filter assets based on it.\",\n    \"description\": \"Select asset Criticality to filter assets based on it.\"\n  },\n  {\n    \"title\": \"Other Filters\",\n    \"name\": \"filters\",\n    \"type\": \"json\",\n    \"visible\": true,\n    \"editable\": true,\n    \"required\": false,\n    \"tooltip\": \"Enter JSON key values to filter the alerts response based on parameters provided. e.g{\\\"asset_id__exact\\\": \\\"122\\\", \\\"severity__exact\\\": 4}\",\n    \"description\": \"Enter JSON key values to filter the alerts response based on parameters provided. e.g{\\\"asset_id__exact\\\": \\\"122\\\", \\\"severity__exact\\\": 4}. list of fields that can be used as key in filters parameters -  page, per_page, asset_id__exact, asset__exact, for_asset__exact, q__exact, primary_asset__exact, non_primary_assets__exact, virtual_zone__exact, alert_id__exact, ot_alerts__exact, family__exact, story_severity__exact, id__exact, site_id__exact, data__exact, description__exact, type__exact, category__exact, severity__exact, timestamp__exact, relevant__exact, resolved__exact, resolution__exact, protocol__exact, score__exact, is_qualified__exact, network_id__exact, resolved_id__exact, assigned_id__exact, story_id__exact, sort\"\n  },\n  {\n    \"title\": \"Limit\",\n    \"name\": \"per_page\",\n    \"type\": \"integer\",\n    \"visible\": true,\n    \"editable\": true,\n    \"required\": false,\n    \"tooltip\": \"Maximum number of alerts to return in response\",\n    \"description\": \"Maximum number of alerts to return in response\"\n  },\n  {\n    \"title\": \"Event Count to Pull Per Alert\",\n    \"name\": \"max_event_count\",\n    \"type\": \"integer\",\n    \"visible\": true,\n    \"editable\": true,\n    \"required\": false,\n    \"tooltip\": \"Maximum number of events to pull per alert\",\n    \"description\": \"Maximum number of events to pull per alert\"\n  }\n]"
                }
              },
              "status": null,
              "top": "40",
              "left": "80",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "23d7566f-a791-4ba2-bff2-6badff10278f",
              "id": 8555
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "filters": "{}",
                "minutes": "5",
                "per_page": "1000",
                "pullTimeMacro": "ClarotyLastEventPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}",
                "max_event_count": "10"
              },
              "status": null,
              "top": "140",
              "left": "240",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "28dacf97-8e0b-4c68-8b97-5759ccbf87d7",
              "id": 8557
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.pullTimeMacro}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "240",
              "left": "420",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "88867266-b23c-42b0-9a24-75bb67be1438",
              "id": 8556
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Time Configuration",
              "description": null,
              "arguments": {
                "filters": "{% if ( vars.filters | length) > 0%}{{vars.filters}}{% else %}{}{% endif %}",
                "curr_timestamp": "{{arrow.utcnow().format('YYYY-MM-DDTHH:mm:ss.SSS')}}Z",
                "last_pull_time": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) > 0%}{{vars.steps.Get_Macro_Value.data['hydra:member'][0]['value']}}{% else %}{{arrow.utcnow().shift(minutes =- (vars.minutes)).format('YYYY-MM-DDTHH:mm:ss.SSS')}}Z{% endif %}"
              },
              "status": null,
              "top": "360",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "d0ad8b66-2326-44a0-af39-a7119d579a7f",
              "id": 8558
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Result",
              "description": null,
              "arguments": {
                "data": "{{vars.steps.Get_Alerts.data.objects}}",
                "curr_timestamp": "{{vars.curr_timestamp}}",
                "max_event_count": "{{vars.max_event_count}}",
                "claroty_macro_name": "{{vars.pullTimeMacro}}"
              },
              "status": null,
              "top": "620",
              "left": "1000",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "ed1ee218-fe9c-4918-bd56-e11e54e3d6ac",
              "id": 8559
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/88867266-b23c-42b0-9a24-75bb67be1438",
              "sourceStep": "/api/3/workflow_steps/28dacf97-8e0b-4c68-8b97-5759ccbf87d7",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "743203df-94d8-4404-b6de-00a00ec8c1a3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Time Configuration -> Get Alerts",
              "targetStep": "/api/3/workflow_steps/08626030-9893-42e4-9ff6-29e432586719",
              "sourceStep": "/api/3/workflow_steps/d0ad8b66-2326-44a0-af39-a7119d579a7f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "93a8efab-1b92-430b-8f7c-ebc8ba1b661e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Set Time Configuration",
              "targetStep": "/api/3/workflow_steps/d0ad8b66-2326-44a0-af39-a7119d579a7f",
              "sourceStep": "/api/3/workflow_steps/88867266-b23c-42b0-9a24-75bb67be1438",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "9be795cd-00aa-4c6e-a501-e951a56321ec"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Alerts -> Set Result",
              "targetStep": "/api/3/workflow_steps/ed1ee218-fe9c-4918-bd56-e11e54e3d6ac",
              "sourceStep": "/api/3/workflow_steps/08626030-9893-42e4-9ff6-29e432586719",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "dfc18c90-1c99-4d48-931c-389287268f9e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/28dacf97-8e0b-4c68-8b97-5759ccbf87d7",
              "sourceStep": "/api/3/workflow_steps/23d7566f-a791-4ba2-bff2-6badff10278f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "fcbdf943-0981-462b-87b1-cfcc4aa14b42"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "c8d134aa-6306-48bb-8dff-d4f650dddee5",
          "id": 719,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Claroty",
            "dataingestion",
            "fetch"
          ],
          "id": 3160,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1666248652,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1666257315,
          "owners": [],
          "isPrivate": false 
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Queries",
          "aliasName": null,
          "tag": "#Claroty",
          "description": "Get all queries and their information based on input parameters you have provided.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1666087154,
          "collection": "/api/3/workflow_collections/8370a01d-a451-4ef2-bbbe-73f1538795a9",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/48013622-2205-4a74-ad92-1600f8754f88",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "d4fe93e2-a45a-4e38-8a21-425f1fd1a4f7",
                "title": "Claroty: Get Queries",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "48013622-2205-4a74-ad92-1600f8754f88",
              "id": 8562
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Queries",
              "description": null,
              "arguments": {
                "name": "Claroty",
                "config": "5393c8c1-36dd-413b-b6b2-1dc1de329995",
                "params": {
                  "page": "",
                  "sort": "",
                  "per_page": "",
                  "site_id__exact": "",
                  "name__icontains": ""
                },
                "version": "1.0.0",
                "connector": "claroty",
                "operation": "get_queries",
                "operationTitle": "Get Queries",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "ba661651-cfd1-4b01-afcd-01410e7f78c7",
              "id": 8561
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Queries",
              "targetStep": "/api/3/workflow_steps/ba661651-cfd1-4b01-afcd-01410e7f78c7",
              "sourceStep": "/api/3/workflow_steps/48013622-2205-4a74-ad92-1600f8754f88",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "71d63690-01ea-4967-a6a1-7c24cb89f8a6"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "d22e49bb-baae-4401-bffd-4a252aa386b1",
          "id": 720,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Claroty"
          ],
          "id": 3161,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1666248652,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1666248652,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Asset Details",
          "aliasName": null,
          "tag": "#Claroty",
          "description": "Get Details of an asset based on resource ID of an asset you have provided.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1680619358,
          "collection": "/api/3/workflow_collections/8370a01d-a451-4ef2-bbbe-73f1538795a9",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/4e9f6839-6183-4cad-80d5-dd7463abe56b",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Asset Details",
              "description": null,
              "arguments": {
                "name": "Claroty",
                "config": "5393c8c1-36dd-413b-b6b2-1dc1de329995",
                "params": {
                  "resource_id": "1-1"
                },
                "version": "1.0.0",
                "connector": "claroty",
                "operation": "get_asset_details",
                "operationTitle": "Get Asset Details",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "34bc0398-ae42-4d69-9558-5cbaef2bbb24",
              "id": 8563
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "7ede1220-2ecf-4ddc-992c-afd18c28694b",
                "title": "Claroty: Get Asset Details",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "4e9f6839-6183-4cad-80d5-dd7463abe56b",
              "id": 8564
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Asset Details",
              "targetStep": "/api/3/workflow_steps/34bc0398-ae42-4d69-9558-5cbaef2bbb24",
              "sourceStep": "/api/3/workflow_steps/4e9f6839-6183-4cad-80d5-dd7463abe56b",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "5bcb1c37-2773-43e8-bbaa-7ac1c9e34ecc"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "e85db9fd-0e8b-4b37-a3b7-453be5b2977e",
          "id": 721,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Claroty"
          ],
          "id": 3162,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1666248652,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1666248652,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Insights Details",
          "aliasName": null,
          "tag": "#Claroty",
          "description": "Get summary of an insights based on insight name you have provided.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1681193219,
          "collection": "/api/3/workflow_collections/8370a01d-a451-4ef2-bbbe-73f1538795a9",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6fd1be49-d8b5-4f34-b3b6-2924916cf358",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "8fd4303b-0b38-4166-a325-01efe0def2f9",
                "title": "Claroty: Get Insights",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "6fd1be49-d8b5-4f34-b3b6-2924916cf358"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Insights Details",
              "description": null,
              "arguments": {
                "name": "Claroty",
                "config": "5393c8c1-36dd-413b-b6b2-1dc1de329995",
                "params": {
                  "page": "",
                  "format": "insight_page",
                  "per_page": "",
                  "ghost__exact": "",
                  "insight_name": "Full Match CVEs",
                  "site_id__exact": "",
                  "special_hint__exact": "",
                  "insight_status__exact": ""
                },
                "version": "1.1.0",
                "connector": "claroty",
                "operation": "get_insight_details",
                "operationTitle": "Get Insight Details",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "c93bb1f3-ec06-487c-8d70-43c8ecad3f42"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Insights",
              "targetStep": "/api/3/workflow_steps/c93bb1f3-ec06-487c-8d70-43c8ecad3f42",
              "sourceStep": "/api/3/workflow_steps/6fd1be49-d8b5-4f34-b3b6-2924916cf358",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "74b55c30-e1f2-4d02-ba65-5cef45a35c4f"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "6b9b730c-f9cf-417b-b128-ce6f0925b391",
          "id": 842,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Claroty"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "Claroty",
    "dataingestion",
    "create",
    "ingest",
    "fetch"
  ]
}